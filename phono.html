<html>
    <head>
        <title>
            Test page for Gordon
        </title>
        <meta http-equiv="PRAGMA" content="NO-CACHE" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="lib/FABridge.js"></script>
        <script type="text/javascript" src="lib/flashembed.min.js"></script>
        <script type="text/javascript" src="lib/phono.js"></script>
    </head>
    <body>
        <h1>
            Test page for Gordon
        </h1>
        <h2>
            Test controls
        </h2>
        
        <div id="phone01" style="height: 1px; width: 1px"></div>
        
        
        <script type="text/javascript">

            var call;
            var phone = $.phono({
                flashElementId:"phone01",
                onConnect: function(event) {
                    window.console.log("callback connected");
                    $("#sessionId").text(event.phone.sessionId);
                    
                },
                onIncomingCall: function(event) {
                    call = event.call;
                }
            });
            function makeCall() {
                numberToDial = $("#destinationTxt").val();
                window.console.log("dialing " + numberToDial);
                call = phone.dial(numberToDial, {
                    pushToTalk: true,
                    headers: {
                        foo:"bar",
                        bling:"blaz"                        
                    },
                    onAnswer: function(event) {
                        window.console.log("callback answered");
                    },
                    onHangup: function() {
                        window.console.log("callback hangup");
                    }
                });
                window.console.log(call);
            }

            $(document).ready(function() {
                window.setInterval(function() {
                    try {
                        $("#phoneState").text(phone.state());
                        if(call != null) {
                            $("#callState").text(call.state());
                        }
                    }
                    catch(e) {
                        window.console.log("ERROR " + e);
                    }
                },500);
            });
            
        </script>
        <form action="bling"> 
            Phone State <span id="phoneState"></span><br/>
            Call State <span id="callState"></span><br/>
            Session ID <span id="sessionId"></span><br/>
            
            <input type="button" value="Call" onClick="makeCall()"/>
            <input type="text" id="destinationTxt" value="app:9991438833" />
            <input type="button" value="Hangup" onClick="call.hangup()"/>
            <input type="button" value="Talk Start" onmousedown="call.talking(true)" onmouseup="call.talking(false)"/>
            <input type="button" value="Mute" onclick="call.muted(true)"/>            
            <input type="button" value="Unmute" onclick="call.muted(false)">
            <input type="button" value="Hold" onclick="if(call.hold()){call.hold(false);this.value='Unhold'}else{call.hold(true);this.value='Hold'}"/>
            <input type="text" value="1" onkeypress="call.volume(this.value)"/>
            <br/>
            <input type="button" value="Accept" onClick="call.accept()"/>
            <input type="button" value="Answer" onClick="call.answer()"/>
            <br/>            
            <input type="button" value="1" name="digit1Button" onClick="call.digit('1')"/>
            <input type="button" value="2" name="digit2Button" onClick="call.digit('2')"/>
            <input type="button" value="3" name="digit3Button" onClick="call.digit('3')"/>
            <input type="button" value="4" name="digit4Button" onClick="call.digit('4')"/>
            <input type="button" value="5" name="digit5Button" onClick="call.digit('5')"/>
            <input type="button" value="6" name="digit6Button" onClick="call.digit('6')"/>
            <input type="button" value="7" name="digit7Button" onClick="call.digit('7')"/>
            <input type="button" value="8" name="digit8Button" onClick="call.digit('8')"/>
            <input type="button" value="9" name="digit9Button" onClick="call.digit('9')"/>
            <input type="button" value="0" name="digit0Button" onClick="call.digit('0')"/>
            <input type="button" value="*" name="digit*Button" onClick="call.digit('*')"/>
            <input type="button" value="#" name="digit#Button" onClick="call.digit('#')"/>
            <br/>
            
            
        </form>

        

    </body>
</html>
